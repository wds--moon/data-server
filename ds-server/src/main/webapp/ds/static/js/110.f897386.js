/*! For license information please see 110.f897386.js.LICENSE.txt */
(self.webpackChunkdm_webapp=self.webpackChunkdm_webapp||[]).push([[110],{34108:function(e,t){"use strict";t.Z={cnn:"/connections"}},45904:function(e,t,r){"use strict";r.d(t,{yh:function(){return u}});var n=r(20144);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return"undefined"!=typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function c(e,t){s(e,t),Object.getOwnPropertyNames(t.prototype).forEach((function(r){s(e.prototype,t.prototype,r)})),Object.getOwnPropertyNames(t).forEach((function(r){s(e,t,r)}))}function s(e,t,r){(r?Reflect.getOwnMetadataKeys(t,r):Reflect.getOwnMetadataKeys(t)).forEach((function(n){var o=r?Reflect.getOwnMetadata(n,t,r):Reflect.getOwnMetadata(n,t);r?Reflect.defineMetadata(n,o,e,r):Reflect.defineMetadata(n,o,e)}))}var l={__proto__:[]}instanceof Array;function u(e){return function(t,r,n){var o="function"==typeof t?t:t.constructor;o.__decorators__||(o.__decorators__=[]),"number"!=typeof n&&(n=void 0),o.__decorators__.push((function(t){return e(t,r,n)}))}}function p(e,t){var r=t.prototype._init;t.prototype._init=function(){var t=this,r=Object.getOwnPropertyNames(e);if(e.$options.props)for(var n in e.$options.props)e.hasOwnProperty(n)||r.push(n);r.forEach((function(r){Object.defineProperty(t,r,{get:function(){return e[r]},set:function(t){e[r]=t},configurable:!0})}))};var n=new t;t.prototype._init=r;var o={};return Object.keys(n).forEach((function(e){void 0!==n[e]&&(o[e]=n[e])})),o}var f=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.name=t.name||e._componentTag||e.name;var r=e.prototype;Object.getOwnPropertyNames(r).forEach((function(e){if("constructor"!==e)if(f.indexOf(e)>-1)t[e]=r[e];else{var n=Object.getOwnPropertyDescriptor(r,e);void 0!==n.value?"function"==typeof n.value?(t.methods||(t.methods={}))[e]=n.value:(t.mixins||(t.mixins=[])).push({data:function(){return a({},e,n.value)}}):(n.get||n.set)&&((t.computed||(t.computed={}))[e]={get:n.get,set:n.set})}})),(t.mixins||(t.mixins=[])).push({data:function(){return p(this,e)}});var o=e.__decorators__;o&&(o.forEach((function(e){return e(t)})),delete e.__decorators__);var s=Object.getPrototypeOf(e.prototype),l=s instanceof n.default?s.constructor:n.default,u=l.extend(t);return v(u,e,l),i()&&c(u,e),u}var y={prototype:!0,arguments:!0,callee:!0,caller:!0};function v(e,t,r){Object.getOwnPropertyNames(t).forEach((function(n){if(!y[n]){var a=Object.getOwnPropertyDescriptor(e,n);if(!a||a.configurable){var i,c,s=Object.getOwnPropertyDescriptor(t,n);if(!l){if("cid"===n)return;var u=Object.getOwnPropertyDescriptor(r,n);if(c=o(i=s.value),null!=i&&("object"===c||"function"===c)&&u&&u.value===s.value)return}Object.defineProperty(e,n,s)}}}))}function m(e){return"function"==typeof e?d(e):function(t){return d(t,e)}}m.registerHooks=function(e){var t;f.push.apply(f,function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(t=e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())},t.ZP=m},18110:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"cnnForm",attrs:{model:e.cnn,"label-width":"100px",rules:e.rules}},[r("h3",[e._v("连接信息")]),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"数据库类型",prop:"dbType"}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.cnn.dbType,callback:function(t){e.$set(e.cnn,"dbType",t)},expression:"cnn.dbType"}},[r("el-option",{attrs:{value:"SQLSERVER"}}),e._v(" "),r("el-option",{attrs:{value:"MySQL8"}}),e._v(" "),r("el-option",{attrs:{value:"PostgreSQL"}}),e._v(" "),r("el-option",{attrs:{value:"Oracle"}}),e._v(" "),r("el-option",{attrs:{value:"DM"}}),e._v(" "),r("el-option",{attrs:{value:"Kingbase"}}),e._v(" "),r("el-option",{attrs:{value:"GBase"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"主机",prop:"host"}},[r("el-input",{attrs:{clearable:""},model:{value:e.cnn.host,callback:function(t){e.$set(e.cnn,"host",t)},expression:"cnn.host"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"端口",prop:"port"}},[r("el-input",{attrs:{clearable:""},model:{value:e.cnn.port,callback:function(t){e.$set(e.cnn,"port",e._n(t))},expression:"cnn.port"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{clearable:""},model:{value:e.cnn.username,callback:function(t){e.$set(e.cnn,"username",t)},expression:"cnn.username"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",clearable:""},model:{value:e.cnn.password,callback:function(t){e.$set(e.cnn,"password",t)},expression:"cnn.password"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"连接名称",prop:"name"}},[r("el-input",{attrs:{clearable:""},model:{value:e.cnn.name,callback:function(t){e.$set(e.cnn,"name",t)},expression:"cnn.name"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"默认数据库",prop:"database"}},[r("el-input",{attrs:{clearable:""},model:{value:e.cnn.database,callback:function(t){e.$set(e.cnn,"database",t)},expression:"cnn.database"}})],1)],1)],1),e._v(" "),e._l(e.properties,(function(t,n){return r("el-form",{key:n,ref:"propForm",refInFor:!0,attrs:{"label-width":"100px",model:e.properties[n],rules:e.propRules}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"属性"+(n+1),prop:"key"}},[r("el-select",{staticStyle:{width:"250px"},attrs:{filterable:""},model:{value:t.key,callback:function(r){e.$set(t,"key",r)},expression:"prop.key"}},e._l(e.propertiesToUser,(function(e){return r("el-option",{key:e,attrs:{value:e}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:16}},[r("el-form-item",{attrs:{label:"属性值",prop:"value"}},[r("el-input",{staticClass:"input-with-select",scopedSlots:e._u([{key:"append",fn:function(){return[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.delProperty(n)}}})]},proxy:!0}],null,!0),model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"prop.value"}})],1)],1)],1)],1)})),e._v(" "),r("el-row",[r("el-col",[r("el-form-item",[r("el-button",{attrs:{type:"success"},on:{click:e.addProperty}},[e._v("添加属性")])],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.cnn.remark,callback:function(t){e.$set(e.cnn,"remark",t)},expression:"cnn.remark"}})],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{staticStyle:{"text-align":"center"},attrs:{"label-width":"0"}},[r("el-button",{attrs:{type:"info"},on:{click:e.test}},[e._v("测试")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("提交")]),e._v(" "),r("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.back()}}},[e._v("取消")])],1)],1)],1)],2)};n._withStripped=!0;var o,a,i=r(20144),c=r(56739),s=r(34108),l=r(55679),u=((o={})[l.ds.S.MySQL8]=["createDatabaseIfNotExist","useUnicode","characterEncoding","autoReconnect","serverTimezone"],o[l.ds.S.SQLSERVER]=[],o),p=r(8078),f=r(59225),d=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),y=function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cnn={dbType:f.S.MySQL8,port:3306},t.properties=[],t.change=!1,t.rules={name:[{required:!0,message:"请输入连接名称",trigger:"blur"},{max:200,message:"内容超过系统长度限制"}],dbType:[{required:!0,message:"数据类型不能为空",trigger:"change"}],host:[{required:!0,message:"主机地址不能为空",trigger:"blur"},{max:100,message:"主机名称过长"}],port:[{type:"integer",min:1,max:65535,required:!0,message:"请输入正确的端口号",trigger:"blur"}],username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{max:200,message:"内容超过系统长度限制"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{max:200,message:"内容超过系统长度限制"}],database:[{max:200,message:"内容超过系统长度限制"}],remark:[{max:4e3,message:"备注长度不能超过4000个字符"}]},t.propRules={key:[{required:!0,message:"属性名不能为空"}],value:[{required:!0,message:"属性值不能为空"}]},t}return d(t,e),Object.defineProperty(t.prototype,"propertiesToUser",{get:function(){var e,t=this.cnn.properties,r=void 0===t?{}:t,n=Object.keys(r);return void 0!==(null===(e=this.cnn)||void 0===e?void 0:e.dbType)?u[this.cnn.dbType].filter((function(e){return!n.includes(e)})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"request",{get:function(){var e=JSON.parse(JSON.stringify(this.cnn));return e.properties&&(e.properties=this.properties.reduce((function(e,t){var r,n=t.key,o=t.value,a=void 0===o?"":o;return y(y({},e),((r={})[n]=a,r))}),{})),e},enumerable:!1,configurable:!0}),t.prototype.addProperty=function(){this.properties.push({key:"",value:""})},t.prototype.delProperty=function(e){var t;null===(t=this.properties)||void 0===t||t.splice(e,1)},t.prototype.checkState=function(e){return p.ZP.post(s.Z.cnn+"/state",e)},t.prototype.created=function(){var e=this;"new"!==this.id&&p.ZP.get(s.Z.cnn+"/"+this.id).then((function(t){var r=t.data;e.cnn=r}))},t.prototype.back=function(){this.$router.go(-1)},t.prototype.test=function(){var e=this;return this.validate().then((function(){return e.checkState(e.request)})).then((function(t){var r=t.data,n=r.result,o=r.message;n?e.$alert("测试成功","连接测试",{type:"success"}):e.$alert("连接测试失败,"+o,"连接测试",{type:"error"})}))},t.prototype.validate=function(){var e,t;return Promise.all(function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}([this.$refs.cnnForm.validate()],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}(null!==(t=null===(e=this.$refs.propForm)||void 0===e?void 0:e.map((function(e){return e.validate()})))&&void 0!==t?t:[])))},t.prototype.submit=function(){var e=this;return this.validate().then((function(){return e.checkState(e.request)})).then((function(t){return t.data.result?"new"===e.id?p.ZP.post(""+s.Z.cnn,e.request):p.ZP.put(s.Z.cnn+"/"+e.id,e.request):(e.$message.error("连接校验失败，不能保存"),Promise.reject(new Error("连接校验失败，不能保存")))})).then(this.back)},v([(0,c.fI)({default:"new"})],t.prototype,"id",void 0),v([(0,c.wA)({})],t)}(i.default),b=(0,r(51900).Z)(m,n,[],!1,null,null,null);b.options.__file="src/modules/cnn/views/Cnn.vue";var h=b.exports},56739:function(e,t,r){"use strict";r.d(t,{wA:function(){return o.ZP},fI:function(){return i},w3:function(){return n.default},RL:function(){return c}});var n=r(20144),o=r(45904),a="undefined"!=typeof Reflect&&void 0!==Reflect.getMetadata;function i(e){return void 0===e&&(e={}),function(t,r){!function(e,t,r){if(a&&!Array.isArray(e)&&"function"!=typeof e&&!e.hasOwnProperty("type")&&void 0===e.type){var n=Reflect.getMetadata("design:type",t,r);n!==Object&&(e.type=n)}}(e,t,r),(0,o.yh)((function(t,r){(t.props||(t.props={}))[r]=e}))(t,r)}}function c(e,t){void 0===t&&(t={});var r=t.deep,n=void 0!==r&&r,a=t.immediate,i=void 0!==a&&a;return(0,o.yh)((function(t,r){"object"!=typeof t.watch&&(t.watch=Object.create(null));var o=t.watch;"object"!=typeof o[e]||Array.isArray(o[e])?void 0===o[e]&&(o[e]=[]):o[e]=[o[e]],o[e].push({handler:r,deep:n,immediate:i})}))}}}]);